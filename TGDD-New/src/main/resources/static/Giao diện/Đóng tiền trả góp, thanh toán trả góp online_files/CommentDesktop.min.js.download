function getParam(n){return oParams[n]}function getPhrase(n){return oTranslations[n]}function parse(n){return n=n.replace(/&(lt|gt);/g,function(n,t){return t=="lt"?"<":">"}),n.replace(/<\/?[^>]+(>|$)/g,"")}function substr(n,t,i){return t<0&&(t+=n.length),i==undefined?i=n.length:i+=i<0?n.length:t,i<t&&(i=t),n.substring(t,i)}function print_r(n,t){var i="",r=function(n,t,i,f){var e;t>0&&t++;var s=u(i*t,f),h=u(i*(t+1),f),o="";if(n instanceof Array||n instanceof Object){o+="Array\n"+s+"(\n";for(e in n)o+=n[e]instanceof Array?h+"["+e+"] => "+r(n[e],t+1,i,f):h+"["+e+"] => "+n[e]+"\n";o+=s+")\n"}else o=n==null||n==undefined?"":n.toString();return o},u=function(n,t){for(var i="",r=0;r<n;r++)i+=t;return i};return i=r(n,0,4," "),t!==!0?(document.write("<pre>"+i+"<\/pre>"),!0):i}function isset(){var t=arguments,i=t.length,n=0;if(i==0)throw new Error("Empty isset");while(n!=i){if(typeof t[n]=="undefined"||t[n]===null)return!1;n++}return!0}function empty(n){var t;if(n===""||n===0||n==="0"||n===null||n===!1||n===undefined||trim(n)=="")return!0;if(typeof n=="object"){for(t in n)if(typeof n[t]!="function")return!1;return!0}return!1}function trim(n,t){var r,u=0,i=0;for(n+="",t?(t+="",r=t.replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1")):r=" \n\r\t\f\x0b            ​\u2028\u2029　",u=n.length,i=0;i<u;i++)if(r.indexOf(n.charAt(i))===-1){n=n.substring(i);break}for(u=n.length,i=u-1;i>=0;i--)if(r.indexOf(n.charAt(i))===-1){n=n.substring(0,i+1);break}return r.indexOf(n.charAt(0))===-1?n:""}function ltrim(n,t){t=t?(t+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1"):" s ";var i=new RegExp("^["+t+"]+","g");return(n+"").replace(i,"")}function rtrim(n,t){t=t?(t+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1"):" s ";var i=new RegExp("["+t+"]+$","g");return(n+"").replace(i,"")}function explode(n,t,i){if(arguments.length<2||typeof arguments[0]=="undefined"||typeof arguments[1]=="undefined")return null;if(n===""||n===!1||n===null)return!1;if(typeof n=="function"||typeof n=="object"||typeof t=="function"||typeof t=="object")return{0:""};if(n===!0&&(n="1"),i){var r=t.toString().split(n.toString()),u=r.splice(0,i-1),f=r.join(n.toString());return u.push(f),u}return t.toString().split(n.toString())}function makeid(){for(var n="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<5;i++)n+=t.charAt(Math.floor(Math.random()*t.length));return n}function cmtLoadnotify(n){socket=io(rtm_host,{transports:["websocket","polling"]});socket.on("connect",function(){socket.emit("join",n)});socket.on("disconnect",function(){discount=discount+1;intervalID=setInterval(tryReconnect,4e3)});socket.on("rdata",function(n){var t=n,r,i;t.security_token!=oCore["log.security_token"]&&(r="<b>"+t.username+"<\/b> "+t.action+" "+t.item+":<i>"+t.content+"<\/i>",cmtnew=cmtnew+1,$("#notifycmtmsg").removeClass("hide"),$("#notifycmtmsg").html("Có bình luận mới được thêm vào. <a href='javascript:' onclick='getCmtNotify();'>Click để xem <\/a>"),$("#notifycmtmsg").removeClass("fixedChat"),console.log("notify: cmt"),i=getCookie("chat.username"),t.action=="CHAT"&&t.username==i&&(console.log("notify: chat"),$("#notifycmtmsg").focus(),$("#notifycmtmsg").removeClass("hide"),$("#notifycmtmsg").html(t.item),$("#notifycmtmsg").removeClass("fixedChat").addClass("fixedChat")))})}function cmtInitEvent(){$Core.loadInit();cmtloadhtml5Upload();cmtCheckCkieUser();$(".wrap_comment .parent_input").unbind();$(".wrap_comment .parent_input").click(function(){$(".wrap_comment .boxemotion").fadeIn()});$(".listcomment .rowuser label").unbind();$(".listcomment .rowuser label").click(function(){var n=$(this).parent().find("a").width(),t;n+=50;console.log(n);t=$(this).parents(".comment_ask").attr("id");$("#"+t).find(".contentconfirm").slideToggle()});$("#js_activity_feed_form #btnSendCmt").unbind();$("#js_activity_feed_form #btnSendCmt").click(function(){});$(".wrap_comment #txtEditorExt").unbind();$(".wrap_comment #txtEditorExt").on("click",function(){$("#txtEditor").click()});$(".ifb").unbind();$(".ifb").off("hover");$(".ifb").hover(function(){var n=$(this).parents(".comment_ask").attr("id");$("#"+n).find(".contentconfirm").show()},function(){});$(".contentconfirm").unbind();$(".contentconfirm").off("hover");$(".contentconfirm").hover(function(){var n=$(this).parents(".comment_ask").attr("id");$("#"+n).find(".contentconfirm").show()},function(){var n=$(this).parents(".comment_ask").attr("id");$("#"+n).find(".contentconfirm").hide()});var n=window.location.href;$(".js_cmt_form").length>0&&n!=null&&n!=""&&$(".js_cmt_form [name='objecturl']").val(n);$(".form_reply").length>0&&n!=null&&n!=""&&$(".form_reply [name='objecturl']").val(n);clearCmtImg();initUploadCmtImg()}function cmtTrigEvent(){$("#comment").on("cmt.err",function(){console.log("cmt.err");cmtOffLoading();removeAllEditor();showTextArea();cmtInitEvent()});$("#comment").on("cmt.loadhtml",function(){console.log("cmt.loadhtml")});$("#comment").on("cmt.rebuildpost",function(){console.log("cmt.rebuildpost");cmtShowEditor();cmtInitEvent();$(".js_cmt_form").length>2&&($(".js_cmt_form").remove(),$("#txtEditor").click())});$("#comment").on("cmt.buildreply",function(){console.log("cmt.buildreply");cmtShowEditor();cmtInitEvent();$("#txtEditor").removeClass("hide")});$("#comment").on("cmt.add",function(){console.log("cmt.add");cmtOffLoading();removeAllEditor();cmtInitEvent();SendCmtSuccess(1);showTextArea();loadCmtPopSucs();cmtSaveInfoToChat()});$("#comment").on("cmt.reply",function(){console.log("cmt.reply");cmtOffLoading();removeAllEditor();cmtInitEvent();SendCmtSuccess(1);showTextArea()});$("#comment").on("cmt.validatecaptcha",function(){cmtShowEditor();cmtOffLoading();SendCmtSuccess()});$("#comment").on("cmt.popupuser",function(){console.log("cmt.popupuser");$(".wrap_comment .ajaxcomment").removeClass("hide");$(".ajaxcomment .wrap_popup .back").unbind();$(".ajaxcomment .wrap_popup .back").click(function(){$(".wrap_comment .ajaxcomment #loadcomment").html("");$(".wrap_comment .ajaxcomment").removeClass("hide").addClass("hide")});$(".cfmPhone").unbind();$(".cfmPhone").keydown(function(n){$.inArray(n.keyCode,[46,8,9,27,13,110,190])!==-1||n.keyCode===65&&(n.ctrlKey===!0||n.metaKey===!0)||n.keyCode>=35&&n.keyCode<=40||(n.shiftKey||n.keyCode<48||n.keyCode>57)&&(n.keyCode<96||n.keyCode>105)&&n.preventDefault()})});$("#comment").on("cmt.popupuseredit",function(){var n;console.log("cmt.popupuseredit");$(".wrap_comment .ajaxcomment").removeClass("hide");n=getCookie("tgdd_fullname");n=Htmlentities(n);var i=getCookie("tgdd_email"),t=getCookie("tgdd_gender"),r=getCookie("tgdd_phone");$(".wrap_popup .cfmUserName").val(n);$(".wrap_popup .cfmUserEmail").val(i);$(".wrap_popup .cfmPhone").val(r);t=parseInt(t);t==1?$(".wrap_comment .forminfo .c_male i").removeClass("iconcom-raduncheck").addClass("iconcom-radcheck"):t==2&&$(".wrap_comment .forminfo .c_female i").removeClass("iconcom-raduncheck").addClass("iconcom-radcheck");$(".ajaxcomment .wrap_popup .back").unbind();$(".ajaxcomment .wrap_popup .back").click(function(){$(".wrap_comment .ajaxcomment #loadcomment").html("");$(".wrap_comment .ajaxcomment").removeClass("hide").addClass("hide")})});$("#comment").on("cmt.listpaging",function(){console.log("cmt.listpaging");setTimeout(function(){cmtInitEvent();$(".wrap_comment img").removeClass("lazy")},500);cmtScrollTop()});$("#comment").on("cmt.search",function(){console.log("cmt.search");cmtInitEvent();cmtScrollTop()});$("#comment").on("cmt.validate",function(){console.log("cmt.validate");cmtShowEditor();cmtOffLoading();SendCmtSuccess()})}function cmtloadhtml5Upload(){$bDocumentIsLoaded=!0;var n="https://cdn.tgdd.vn/comment";$Core.loadStaticFiles([n+"/Scripts/jquery.html5uploader.min.js"]);$Core.loadStaticFiles([n+"/Scripts/jquery.lazyload.min.js"])}function cmtGetextParam(){return"objectTitle="+CMTencodeURIComponent($("#comment").attr("nameproduct"))+"&objectUrl="+CMTencodeURIComponent($("#comment").attr("urlpage"))+"&hiderating="+CMTencodeURIComponent($("#comment").attr("hiderating"))+"&pageSize="+CMTencodeURIComponent($("#comment").attr("pageSize"))+"&objectid="+$("#comment").attr("detailid")+"&objecttype="+$("#comment").attr("cmtcategoryid")+"&siteID="+$("#comment").attr("siteId")+"&objectUrlRe="+CMTencodeURIComponent(location.href)+"&ClearCacheUrl="+CMTencodeURIComponent($("#comment").attr("clearcacheurl"))}function CMTencodeURIComponent(n){return empty(n)?"":encodeURIComponent(n)}function cmtCheckCkieUser(){var n=getCookie("tgdd_fullname"),u=getCookie("tgdd_email"),t=getCookie("tgdd_social"),f=getCookie("tgdd_gender"),i=getCookie("chat.username"),r=getCookie("chat.username"),e,o;i!=null&&i!=""&&(g_cmt_ChatUserName=i,$("#js_activity_feed_form").length>0&&$("#js_activity_feed_form [name='chatcookie']").val(r),$(".form_reply").length>0&&$(".form_reply [name='chatcookie']").val(r));n!=null&&n!=""&&(n=Htmlentities(n),$("#js_activity_feed_form").length>0&&($("#js_activity_feed_form [name='sendwithname']").val(n),$("#js_activity_feed_form [name='sendwithemail']").val(u),$("#js_activity_feed_form [name='gender']").val(f),$("#js_activity_feed_form [name='chatcookie']").val(r),t!=null&&t!=""&&$("#js_activity_feed_form [name='sendwithIfoSocial']").val(t),$("#js_activity_feed_form [name='chatusername']").val(i),e=cmtBuildHtmlShortName(n),$("#js_activity_feed_form .usermember").html(cmtBuildHtmlShortName(n))),$(".form_reply").length>0&&($(".form_reply [name='sendwithname']").val(n),$(".form_reply [name='sendwithemail']").val(u),$(".form_reply [name='gender']").val(f),$(".form_reply [name='chatcookie']").val(r),t!=null&&t!=""&&$(".form_reply [name='sendwithIfoSocial']").val(t),$(".form_reply [name='chatusername']").val(i),e=cmtBuildHtmlShortName(n),$(".form_reply .usermember").html(cmtBuildHtmlShortName(n))));o=getCookie("TGDD_WEB_LAYOUT");o=="SHOPPING"&&($(".js_cmt_form").length>0&&$(".js_cmt_form [name='iVersion']").val("2"),$(".form_reply").length>0&&$(".form_reply [name='iVersion']").val("2"))}function CreateCookie(n,t,i){var r=new Date,u;r.setDate(r.getDate()+i);u=escape(t)+(i==null?"":"; visited=true; path=/; domain="+rooturl+"; expires="+r.toUTCString()+";");document.cookie=n+"="+u}function getCookie(n){for(var r,u,i=document.cookie.split(";"),t=0;t<i.length;t++)if(r=i[t].substr(0,i[t].indexOf("=")),u=i[t].substr(i[t].indexOf("=")+1),r=r.replace(/^\s+|\s+$/g,""),r==n)return unescape(u)}function Delete_Cookie(n,t,i){getCookie(n)&&(document.cookie=n+"="+(t?";path="+t:"")+(i?";domain="+i:"")+";expires=Thu, 01 Jan 1970 00:00:01 GMT")}function cmtaddcommentclick(){removeAllEditor();$bDocumentIsLoaded=!0;$.ajaxCall("cmt.rebuildpost",cmtGetextParam());setTimeout(function(){$("#js_activity_feed_form .dropfirst").click();savedRange=null;$("#js_activity_feed_form #content").focus();saveSelection()},1e3)}function cmtShowEditor(){$("#txtEditor").removeClass("hide").addClass("hide");$(".js_cmt_form #content").length>0&&($(".js_cmt_form #content").focus(),$(".js_cmt_form .loading").removeClass("hide").addClass("hide"),$(".js_cmt_form .btnSend").removeClass("hide"));$(".form_reply #content").length>0&&($(".form_reply #content").focus(),$(".form_reply .loading").removeClass("hide").addClass("hide"),$(".form_reply .btnSend").removeClass("hide"));savedRange=null;saveSelection()}function removeAllEditor(){$(".wrap_comment .js_cmt_form").each(function(){$(this).remove()});$(".wrap_comment .form_reply").each(function(){$(this).remove()});$(".wrap_comment #txtEditor").removeClass("hide")}function saveSelection(){window.getSelection?savedRange=window.getSelection().getRangeAt(0):document.selection&&(savedRange=document.selection.createRange());countRowEditor()}function countRowEditor(){$("#js_activity_feed_form #content div").length>10?$("#js_activity_feed_form #content").css("overflow-y","scroll"):$("#js_activity_feed_form #content").css("overflow-y","visible")}function cmtSend(){var n=$.trim($("#js_activity_feed_form #content").val());if($("#js_activity_feed_form [name='cmtLast']").val($(".listcomment .comment_ask").first().attr("id")),n==""||n==null||n=="Vui lòng nhập nội dung")return $("#js_activity_feed_form #content").focus(),$(".lbMsgCmt").html("Vui lòng nhập nội dung"),setTimeout(function(){$("#js_activity_feed_form #content").html("")},700),cmtOffLoading(),!1;var t=$.trim($("#js_activity_feed_form [name='sendwithname']").val()),i=$.trim($("#js_activity_feed_form [name='sendwithemail']").val()),r=$.trim($("#js_activity_feed_form [name='sendwithphone']").val()),u=$.trim($("#js_activity_feed_form [name='loginemail']").val()),f=$.trim($("#js_activity_feed_form [name='loginpass']").val());if(t==""&&i=="")return $.ajaxCall("cmt.popupuser",cmtGetextParam()),!1;$("#js_activity_feed_form").submit();cmtShowLoading()}function cmtSendReply(){var n=$.trim($(".form_reply #content").val()),t=$(".form_reply").attr("id");if(t=t.replace("js_activity_feed_form_",""),$("#r"+t+" .comment_ask").length>0&&$(".form_reply [name='cmtLast']").val($("#r"+t+" .reply").last().attr("id")),n==""||n==null||n=="Vui lòng nhập nội dung")return $(".form_reply #content").focus(),$(".form_reply #content").html("Vui lòng nhập nội dung"),setTimeout(function(){$(".form_reply #content").html("")},700),cmtOffLoading(),!1;var i=$.trim($(".form_reply [name='sendwithname']").val()),r=$.trim($(".form_reply [name='sendwithemail']").val()),u=$.trim($(".form_reply [name='sendwithphone']").val()),f=$.trim($(".form_reply [name='loginemail']").val()),e=$.trim($(".form_reply [name='loginpass']").val());if(i==""&&r=="")return $.ajaxCall("cmt.popupuser",cmtGetextParam()),!1;n=$.trim($(".form_reply #content").val());$(".form_reply [name='content']").val(n);$(".form_reply [name='dataContent']").val(n);$(".form_reply").submit();cmtShowLoading()}function cmtOffLoading(){$(".wrap_comment .btnSend").removeClass("hide");$(".wrap_comment .loading").addClass("hide");$("#content").val("")}function cmtConfirmUser(n,t){var u=$.trim($(".wrap_comment .wrap_popup .cfmUserEmail").val()),i,r,f;if($("#js_activity_feed_form").length>0&&(u=$("#js_activity_feed_form [name='gender']").val()),$(".form_reply").length>0&&(u=$(".form_reply [name='gender']").val()),u=parseInt(u),!(u==2||u==1)&&!t)return $(".lbMsgPopCmt").html("Vui lòng chọn giới tính"),!1;if(i=$.trim($(".wrap_comment .wrap_popup .cfmUserName").val()),i=="")return $(".lbMsgPopCmt").html("Vui lòng nhập họ tên."),!1;if(cmtValidateName(i)==!1)return $(".lbMsgPopCmt").html("Vui lòng nhập họ tên đúng định dạng (phải có ký tự từ a đến z)."),!1;if(r=$.trim($(".wrap_comment .wrap_popup .cfmUserEmail").val()),r!=null&&r!=""&&cmtValidateEmail(r)==!1)return $(".lbMsgPopCmt").html("Email không đúng định dạng"),!1;if(f=$.trim($(".wrap_comment .wrap_popup .cfmPhone").val()),i=cmtFilterText(i),r=cmtFilterText(r),f=cmtFilterText(f),n)return saveCkieUser(i,r,u,f),$(".js_cmt_form").length>0&&($(".js_cmt_form .usermember").html(cmtBuildHtmlShortName(i)),$(".js_cmt_form [name='sendwithname']").val(i),$(".js_cmt_form [name='sendwithemail']").val(r),$(".js_cmt_form [name='sendwithphone']").val(f),$(".js_cmt_form [name='gender']").val(u)),$(".form_reply").length>0&&($(".form_reply .usermember").html(cmtBuildHtmlShortName(i)),$(".form_reply [name='sendwithname']").val(i),$(".form_reply [name='sendwithemail']").val(r),$(".form_reply [name='sendwithphone']").val(f),$(".form_reply [name='gender']").val(u)),$(".wrap_comment .wrap_popup .back").click(),console.log("trig event cmtFinishEditInfo"),$("#comment").trigger("cmtFinishEditInfo"),!1;$(".js_cmt_form").length>0&&($(".js_cmt_form [name='sendwithname']").val(i),$(".js_cmt_form [name='sendwithemail']").val(r),$(".js_cmt_form [name='sendwithphone']").val(f),$(".wrap_comment .wrap_popup .back").click(),cmtSend());$(".form_reply").length>0&&($(".form_reply [name='sendwithname']").val(i),$(".form_reply [name='sendwithemail']").val(r),$(".form_reply [name='sendwithphone']").val(f),$(".wrap_comment .wrap_popup .back").click(),cmtSendReply())}function cmtValidateEmail(n){return/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(n)}function cmtValidateName(n){return n.match(/[a-z]/i)?!0:!1}function cmtShowLoading(){$(".wrap_comment .js_cmt_form").length>0&&($(".wrap_comment .js_cmt_form .btnSend").addClass("hide"),$(".wrap_comment .js_cmt_form .loading").removeClass("hide"));$(".wrap_comment .form_reply").length>0&&($(".wrap_comment .form_reply .btnSend").addClass("hide"),$(".wrap_comment .form_reply .loading").removeClass("hide"))}function SendCmtSuccess(){isSendingCmt=!1}function showTextArea(){setTimeout(function(){$(".wrap_comment #txtEditor").removeClass("hide")},1e3)}function saveCkieUser(n,t,i,r){n=Htmlentities(n);CreateCookie("tgdd_fullname",n,30);CreateCookie("tgdd_email",t,30);isNaN(i)&&(i=0);CreateCookie("tgdd_gender",i,30);r!=null&&r!=""&&CreateCookie("tgdd_phone",r,30)}function cmtInsertReplyImg(n){cmtattachfile(n);$(".form_reply #upload-image").click()}function cmtGetShortName(n){return n.split(" ").map(function(n){return n[0]}).join("")}function cmtBuildHtmlShortName(n){var r=cmtGetShortName(n),t=getCookie("tgdd_social"),u="",i;if(t!=null&&t!=""){var f=t.split("_"),e=f[0],o=f[1];sHtml="";o==4&&(u+="<img class='avaS' src=\"https://graph.facebook.com/"+e+'/picture?width=25&height=25" >')}return r.length>2&&(r=r.substr(0,2)),i="",i+=u,i+="<span>"+n+"<\/span>",i+(t!=null&&t!=""?"<a href='javascript:void(0)' onclick=\"logoutSocial()\" >(Thoát)<\/a>":"<a href='javascript:void(0)' onclick=\"cmtEditName()\" >(Thay đổi)<\/a>")}function clearCookie(){Delete_Cookie("tgdd_email","/",hostName);Delete_Cookie("tgdd_fullname","/",hostName);Delete_Cookie("tgdd_gender","/",hostName);Delete_Cookie("tgdd_social","/",hostName);$("#js_activity_feed_form").length>0&&($("#js_activity_feed_form [name='sendwithname']").val(""),$("#js_activity_feed_form [name='sendwithemail']").val(""),$("#js_activity_feed_form [name='loginemail']").val(""),$("#js_activity_feed_form [name='loginpass']").val(""));$(".form_reply").length>0&&($(".form_reply [name='sendwithname']").val(""),$(".form_reply [name='sendwithemail']").val(""),$(".form_reply [name='loginemail']").val(""),$(".form_reply [name='loginpass']").val(""));$(".wrap_comment .usermember").html("")}function cmtLogout(){clearCookie()}function showFullCmt(n){$("#"+n+" .reply").removeClass("hide");$("#"+n+" .fullcomment").remove()}function cmtaddreplyclick(n){removeAllEditor();$(".form_reply").each(function(){$(this).remove()});$bDocumentIsLoaded=!0;$.ajaxCall("cmt.buildreply",cmtGetextParam()+"&ParentID="+n);setTimeout(function(){var t=$("#"+n+" .rowuser strong").html();$(".form_reply #content").append("@"+t+": ");placeCaretAtEnd(document.getElementById("content"))},1e3)}function cmtChildAddReplyClick(n,t){removeAllEditor();$(".comment_reply .form_reply").each(function(){$(this).remove()});$bDocumentIsLoaded=!0;$.ajaxCall("cmt.buildreply",cmtGetextParam()+"&ParentID="+t+"&typeReply=2&cmtReply="+n);setTimeout(function(){var t=$("#"+n+" .rowuser strong").html();$(".form_reply #content").append("@"+t+": ");placeCaretAtEnd(document.getElementById("content"))},500)}function listcomment(n,t,i){cmtnew=0;$("#notifycmtmsg").html("");$.ajaxCall("cmt.listpaging",cmtGetextParam()+"&pageindex="+i+"&Type="+n+"&order="+t)}function cmtScrollTop(){$("html, body").bind("scroll mousedown DOMMouseScroll mousewheel keyup",function(){$("html, body").stop()});$("html, body").animate({scrollTop:$("#comment").offset().top},2e3)}function selCmt(n){window.event.ctrlKey&&alert(n)}function DelImg(n){$(n).parent().parent().remove()}function expandCmt(n){$("#"+n).find(".quest").removeClass("hide");$("#"+n).find(".quest_s").remove();$(window).scroll()}function expandCmtChild(n){$("#"+n).find(".content").removeClass("hide");$("#"+n).find(".content_s").remove();$(window).scroll()}function cmtEditName(){$.ajaxCall("cmt.popupuseredit",cmtGetextParam())}function animateCmt(n,t){$("#"+n).removeClass("trCmtChild").removeClass("trCmt").removeClass("trCmtNew").addClass("trCmtNew");setTimeout(function(){t==1?($("#"+n).parent().removeClass("hide"),$("#"+n).removeClass("trCmtNew").removeClass("trCmtChild").addClass("trCmtChild")):$("#"+n).removeClass("trCmtNew").removeClass("trCmt").addClass("trCmt")},500)}function cmtFilterText(n){return n=n.replace(/<(?:.|\n)*?>/gm,""),n.replace(/'/g,"")}function getCmtNotify(){$("#notifycmtmsg").removeClass("hide").addClass("hide");listcomment(2,1,0)}function cmtReport(n){$("#wre"+n).slideToggle()}function cmtSubmitReport(n,t,i){cmtReport(n);var r=getCookie("tgdd_fullname"),u=getCookie("tgdd_email");if(r==null||r=="")return cmtEditName(),!1;r=CMTencodeURIComponent(r);r=Htmlentities(r);u=CMTencodeURIComponent(u);$.ajaxCall("cmt.report",cmtGetextParam()+"&RpCmtID="+n+"&RpType="+t+"&RpReason="+i+"&RpUserName="+r+"&RpEmail="+u)}function cmtReportFinish(n,t){var r="vi phạm",i;t==2&&(r="sai");i="<div class='boxnotifi'>";i+="<i class='iconcom-send'><\/i>";i+="Nội dung bạn báo "+r+" đã được gửi đi và sẽ được  xử lý trong 24 giờ<\/div>";$("#"+n).find(".actionuser").first().after(i)}function OpenLoginWindow(n){var r=domainName+"/auth?socialType="+n,t=screen.availWidth*.8,i=screen.availHeight*.6,u=(screen.availWidth-t)/2,f=(screen.availHeight-i)/2;window.socialWindow=window.open(r,"SignIn","width="+t+",height="+i+",toolbar=no,resizable=fixed,status=no,scrollbars=no,menubar=no,screenX="+u+",screenY="+f);socialWindow.focus();return}function SetUserSocial(n,t,i,r){CreateCookie("tgdd_fullname",t,30);CreateCookie("tgdd_email",i,30);CreateCookie("tgdd_social",n+"_"+r,30);var u=n+"_"+r;$(".wrap_comment .wrap_popup .cfmUserName").val(t);$(".wrap_comment .wrap_popup .cfmUserEmail").val(i);cmtConfirmUser(!0);cmtCheckCkieUser()}function logoutSocial(){clearCookie();$.ajaxCall("cmt.logout",cmtGetextParam())}function cmtSearch(n){var r=n.keyCode?n.keyCode:n.which,t,i;if(r==13){if(t=$(".s_comment .cmtKey").val(),t=$.trim(t),t==null||t=="")return $(".lbMsgCmt").html("Vui lòng nhập nội dung cần tìm kiếm"),!1;i=$(".fts_comment").attr("data-val");$.ajaxCall("cmt.search",cmtGetextParam()+"&cmtOrderType="+i+"&cmtPageIndex=0&cmtKey="+CMTencodeURIComponent(t))}}function addMsgCmtReply(){$("#comment .listcomment li").first().find(".actionuser").after('<div class="replyLate">Quản trị viên sẽ phản hồi bình luận trước 10h sáng.<\/div>')}function MsgHideCmt(n){alert("Cảm ơn khách hàng "+n+" đã chọn dịch vụ của Thegioididong.com ,QTV sẽ phản hồi bình luận trước 10h ngày mai, chúc khách hàng ngày mới nhiều niềm vui.");setTimeout(function(){$(".wrapcomment .txtEditor").removeClass("hide");addMsgCmtReply()},500)}function MsgHideCmt_Warning(n){alert("Cảm ơn khách hàng "+n+" đã chọn dịch vụ của Thegioididong.com ,QTV sẽ phản hồi bình luận trước 10h ngày mai, chúc khách hàng ngày mới nhiều niềm vui.");setTimeout(function(){$(".wrapcomment .txtEditor").removeClass("hide");addMsgCmtReply()},500)}function MsgHideCmtTech1(n,t){alert("Cảm ơn "+t+" "+n+" đã chọn dịch vụ của Thegioididong.com, QTV sẽ phản hồi bình luận trước 10h ngày mai, chúc "+t+" ngày mới nhiều niềm vui.");setTimeout(function(){$(".wrapcomment .txtEditor").removeClass("hide");addMsgCmtReply()},500)}function MsgHideCmtTech2(n){alert("Cảm ơn "+gender+" "+n+" đã chọn dịch vụ của Thegioididong.com, QTV sẽ phản hồi bình luận trước 10h sáng, chúc "+gender+" ngày mới nhiều niềm vui.");setTimeout(function(){$(".wrapcomment .txtEditor").removeClass("hide");addMsgCmtReply()},500)}function showCmtTech(){$(".midcmt .tech").find("i").attr("class","iconcom-check");$(".midcmt .tech").attr("onclick","hideCmtTech()");listcomment(2,5,0)}function hideCmtTech(){$(".midcmt .tech").find("i").attr("class","iconcom-uncheck");$(".midcmt .tech").attr("onclick","showCmtTech()");listcomment(2,1,0)}function selGender(n,t){$(".forminfo .cgd i").removeClass("iconcom-radcheck").addClass("iconcom-raduncheck");$(n).find("i").removeClass("iconcom-raduncheck").addClass("iconcom-radcheck");$("#js_activity_feed_form").length>0&&$("#js_activity_feed_form [name='gender']").val(t);$(".form_reply").length>0&&$(".form_reply [name='gender']").val(t)}function cmtClosePop(){$(".wrap_comment .ajaxcomment #loadcomment").html("");$(".wrap_comment .ajaxcomment").removeClass("hide").addClass("hide")}function satisfiedCmt(n){var t;$.ajaxCall("cmt.satis",cmtGetextParam()+"&commentID="+n+"&iTypeSatisfied=1&sDescriptSatisfied=");$("#"+n+" .satis").find(".iconcom-like").removeClass("iconcom-like").addClass("iconcom-likeAct");$(".mwrs").remove();t="<span class='mwrs'>Cám ơn bạn đã góp ý cho QTV<\/span>";$("#wrs"+n).after(t);$(".mwrs").fadeOut(7e3);setTimeout(function(){$(".mwrs").remove()},8e3)}function unsatisfiedCmt(n){$(".wrapsatis").hide();$("#wrs"+n).slideToggle()}function sendUnSatisfied(n){var t=$.trim($("#wrs"+n+" .ustCt").val()),i=$.trim($("#wrs"+n+" .ustName").val()),r=$.trim($("#wrs"+n+" .ustPhone").val()),u;if(t!=""&&t!=null){if(t.length<10)return alert("Nội dung quá ít. Vui lòng nhập thêm."),!1;if(r.length>0&&i.length==0)return alert("Vui lòng nhập họ tên."),!1;t=CMTencodeURIComponent(t);$.ajaxCall("cmt.satis",cmtGetextParam()+"&commentID="+n+"&iTypeSatisfied=2&sDescriptSatisfied="+t+"&sNameSatisfied="+i+"&sPhoneSatisfied="+r);$(".wrapsatis").hide();$(".wrapsatis input").val("");$("#"+n+" .satis").find(".iconcom-unlike").removeClass("iconcom-unlike").addClass("iconcom-unlikeAct");u="<span class='mwrs'>Cám ơn bạn đã góp ý cho QTV<\/span>";$("#wrs"+n).after(u);$(".mwrs").fadeOut(7e3);setTimeout(function(){$(".mwrs").remove()},8e3)}}function closeSatis(){$(".wrapsatis").hide()}function MsgHideCmt_Tet1(){alert("Cám ơn quý khách đã để lại bình luận, bình luận sẽ được phản hồi từ ngày 06/02.\nChúc quý khách năm mới nhiều sức khỏe.");cmtOffLoading();setTimeout(function(){$(".wrapcomment .txtEditor").removeClass("hide")},500)}function initUploadCmtImg(){setTimeout(function(){$(".btnCmtUpload").unbind();$(".btnCmtUpload").on("click",function(){if(console.log("up Img Cmt"),$(".resCmtImg li").length>2)return console.log("đã up load quá số ảnh quy định"),!1;$("#hdFileCmtUpload").click()});var n=getParam("sJsHome")+"/aj/Cmt/PostCmtImage";$("#hdFileCmtUpload").unbind();$("#hdFileCmtUpload").html5Uploader({postUrl:n,onClientLoadStart:function(){console.log("onClientLoadStart - upload feedbackIMG")},onServerLoadStart:function(){},onServerProgress:function(){},onServerLoad:function(){},onSuccess:function(n){var i=$.parseJSON(n.currentTarget.response),t;if(i.status==-1){$(".lbMsgCmt").html("Xảy ra lỗi, vui lòng thử lại.");return}console.log("onSuccess - upload CmtIMG");t="<li data-imgName='"+i.imageName+"'  >";t+="<img src='"+i.imageUrl+"' />";t+="<i class='fbDelImg' onclick='delCmtImg(this)'>x<\/i>";t+="<\/li>";$(".resCmtImg").append(t);$(".resCmtImg").removeClass("hide");getCmtImg()}})},1e3)}function getCmtImg(){if($(".resCmtImg li").length>0){var n="";$(".resCmtImg li").each(function(){var t=$(this).attr("data-imgname");t!=null&&t!=""&&(n+=t+"╬")});$(".hdfCmtImg").val(n)}else $(".resCmtImg li").length==0&&$(".hdfCmtImg").val("")}function clearCmtImg(){$(".resCmtImg").html("");$(".lbMsgCmt").html("")}function delCmtImg(n){$(n).parent().remove();getCmtImg()}function loadCmtPopSucs(){var n;$(".ajaxcomment").removeClass("hide");var i=new Date,t="";isInRange(i.toTimeString().split(" ")[0],["09:00:00","21:31:00"])||(t=" trước 9h ngày mai",isInRange(i.toTimeString().split(" ")[0],["00:00:01","08:59:59"])&&(t=" trước 9h"));n="<div class='wrap_popup_success'>";n+="<i class='iconcom-success'><\/i>";n+="<span>Cảm ơn quý khách để lại bình luận, bình luận sẽ được kiểm duyệt và cập nhật lên web"+t+".<\/span>";n+="<\/div>";$(".ajaxcomment #loadcomment").append(n);$(".wrap_popup_success").fadeOut(6e3);setTimeout(function(){$(".ajaxcomment").addClass("hide");$(".wrap_popup_success").remove()},3e3)}function isInRange(n,t){return n>=t[0]&&n<=t[1]}function openCmtSlide(n,t){if(gl_rsCmtPS)$.ajaxCall("cmt.showimg","commentID="+n,"GET");else{var i="https://www.thegioididong.com/Content/mobile/css/V2/default-skin.min.css",r="https://www.thegioididong.com/Scripts/mobile/photoswipe.min.js",u="https://www.thegioididong.com/Scripts/mobile/photoswipe-ui-default.min.js";$.when($.get("https://www.thegioididong.com/Content/mobile/css/V2/photoswipe.min.css")).done(function(f){$("<style />").text(f).appendTo($("head"));$.when($.get(i)).done(function(i){$("<style />").text(i).appendTo($("head"));console.log("get css photoswipe OK");$.getScript(r).done(function(){$.getScript(u).done(function(){console.log("get resource photoswipe OK");gl_rsCmtPS=!0;openCmtSlide(n,t)})})})})}}function initSlideCmt(){var i,r,n,e,o;if(console.log("RUN SLIDE CMT"),i=$("#hdfSlideCmt").attr("data-url"),r=$("#hdfSlideCmt").attr("data-size"),i!=null&&i!=""){var t=i.split(";"),s=r.split(";"),u=[],h=document.querySelectorAll(".pswp")[0];if(t!=null&&t.length>0)for(n=0;n<t.length;n++)if(t[n]!=""){var f=s[n].split("x"),c=parseInt(f[0]),l=parseInt(f[1]),a={src:t[n],w:c,h:l};u.push(a)}e={history:!1,focus:!1,showAnimationDuration:0,hideAnimationDuration:0,tapToToggleControls:!1};o=new PhotoSwipe(h,PhotoSwipeUI_Default,u,e);o.init()}}function cmtSaveInfoToChat(){var n=getCookie("tgdd_fullname"),t=getCookie("tgdd_email"),i=getCookie("tgdd_gender"),r=getCookie("tgdd_gender");typeof SaveCookieUserInfo=="function"&&SaveCookieUserInfo(n,t,r,i)}function cmt_selOdSeach(n){var t,i;if($(".fts_comment .c_ods i").attr("class",""),$(".fts_comment").attr("data-val",n),n==0?($(".fts_comment .c_ods_d i").addClass("iconcom-radcheck"),$(".fts_comment .c_ods_m i").addClass("iconcom-raduncheck")):n==1&&($(".fts_comment .c_ods_d i").addClass("iconcom-raduncheck"),$(".fts_comment .c_ods_m i").addClass("iconcom-radcheck")),t=$(".cmtKey").val(),t==null||t=="")return $(".lbMsgCmt").html("Vui lòng nhập nội dung cần tìm kiếm"),!1;i=$(".fts_comment").attr("data-val");$.ajaxCall("cmt.search",cmtGetextParam()+"&cmtOrderType="+i+"&cmtPageIndex=0&cmtKey="+CMTencodeURIComponent(t))}function passedSendCmt(){$(".captchacmt").addClass("hide");$(".lbMsgCmt").html()}function Htmlentities(n){return n.replace(/[\u00A0-\u9999<>\&]/g,function(n){return"&#"+n.charCodeAt(0)+";"})}var oCacheAjaxRequest,aCacheAjaxLastCall,discount,reconnectCount,tryReconnect,savedRange,isInFocus,cmtnew,gl_rsCmtPS;$.ajaxBox=function(n,t){var i=getParam("sJsAjax")+"?"+getParam("sGlobalTokenName")+"[ajax]=true&"+getParam("sGlobalTokenName")+"[call]="+n;return t&&(i+="&"+t),i.match(/\[security_token\]/i)||(i+="&"+getParam("sGlobalTokenName")+"[security_token]="+oCore["log.security_token"]),i};$.ajaxBoxOut=function(n,t){console.log("cmtAJBO");$.ajax({url:n,type:"POST",dataType:"json",data:t,error:function(){},success:function(){}})};oCacheAjaxRequest=null;aCacheAjaxLastCall={};window.onbeforeunload=function(){oCacheAjaxRequest!==null&&oCacheAjaxRequest.abort()};$.fn.ajaxCall=function(n,t,i,r){console.log("cmtAJ_f");empty(r)&&(r="POST");var f=getParam("sJsAjax"),u="&"+getParam("sGlobalTokenName")+"[ajax]=true&"+getParam("sGlobalTokenName")+"[call]="+n+""+(i?"":this.getForm());return t&&(u+="&"+ltrim(t,"&")),u.match(/\[security_token\]/i)||(u+="&"+getParam("sGlobalTokenName")+"[security_token]="+oCore["log.security_token"]),getParam("bJsIsMobile")&&(u+="&js_mobile_version=true"),oCacheAjaxRequest=$.ajax({type:r,url:f,dataType:"jsonp",data:u})};$.ajaxCall=function(n,t,i){return $.fn.ajaxCall(n,t,!0,i)};$.fn.getForm=function(){var h=!1,c=!1,o=0,r=this.get(0),s="",l=!1,i,t,n,u,f,e;if(arguments.length>1&&arguments[1]==!0&&(l=!0),arguments.length>2&&(s=arguments[2]),i="",r&&r.tagName=="FORM")for(t=r.elements,n=0;n<t.length;n++)if(t[n].name&&t[n].name.substring(0,s.length)==s&&(!t[n].type||t[n].type!="radio"&&t[n].type!="checkbox"||t[n].checked!=!1)&&(!t[n].disabled||t[n].disabled!=!0||l!=!1)&&(u=t[n].name,u)){if(i+="&",t[n].type=="select-multiple")for(f=0;f<t[n].length;f++)t[n].options[f].selected==!0&&(i+=u+"="+encodeURIComponent(t[n].options[f].value)+"&");else i+=u+"="+encodeURIComponent(t[n].value);u=="parentid"&&t[n].value!=""&&(o=parseInt(t[n].value,10),o>0&&(h=!0));u=="isedit"&&t[n].value!=""&&(c=!0)}!i&&r&&(i+="&"+r.name+"="+encodeURIComponent(r.value));e="";c==!1?h==!1?(i+="&content="+encodeURIComponent($("#content").html()),e=$("#content").html()):(i+="&content="+encodeURIComponent($("#content-"+o+"").html()),e=$("#content-"+o+"").html()):i+="&content="+encodeURIComponent($("#commenteditcontent").html());try{empty(e)==!1&&loadOfferWithComment(e)}catch(a){}return i};var sClientInfo=navigator.userAgent.toLowerCase(),bIsIE=sClientInfo.indexOf("msie")!=-1,bIsWin=sClientInfo.indexOf("win")!=-1||sClientInfo.indexOf("16bit")!=-1;var $Core={},$Behavior={},$Cache={},$oEventHistory={},$oStaticHistory={},$bDocumentIsLoaded=!1,rtm_host=("https:"==document.location.protocol?"https://":"http://")+"rtm.thegioididong.com",cmtFirstload=!0,cmtroom="",g_cmt_ChatUserName="",oCore={"core.is_admincp":!1,"core.section_module":"core","log.security_token":makeid()},sCustomHistoryUrl="",oParams={sJsHome:"https://www.thegioididong.com/commentnew",sJsHomeU:"https://www.thegioididong.com/commentnew",sSiteName:"tgdd",sJsAjax:"https://www.thegioididong.com/commentnew/cmt/index",sStaticVersion:"977ce5003566dfb5058d954b0ea87d35",sGlobalTokenName:"core",bJsIsMobile:!1,"notification.notify_ajax_refresh":2},domainName="http://www.thegioididong.com/commentnew",hostName=".thegioididong.com";$Core.init=function(){$bDocumentIsLoaded=!0;$(document).ready(function(){$.each($Behavior,function(){this(this)})});$("script,link").each(function(){var n,t;if(empty(this.src)){if(!empty(this.href)&&(n=this.href,this.href.indexOf("f=")!==-1)){var i=explode("f=",n),t=explode("&v=",i[1]),r=explode(",",t[0]);$(r).each(function(n,t){$oStaticHistory[getParam("sJsHome")+t]=!0});return}}else if(n=this.src,this.src.indexOf("f=")!==-1){var i=explode("f=",n),t=explode("&v=",i[1]),r=explode(",",t[0]);$(r).each(function(n,t){substr(t,0,7)=="module/"?$oStaticHistory[getParam("sJsHome")+t]=!0:$oStaticHistory[getParam("sJsStatic")+"jscript/"+t]=!0});return}empty(n)||(t=explode("?",n),$oStaticHistory[t[0]]=!0)});isset($Cache.post_static_files)&&$($Cache.post_static_files).each(function(n,t){$Core.loadStaticFiles(t)})};$Core.loadInit=function(){$(".js_cmt_form").unbind();$(".form_reply").unbind();$.each($Behavior,function(){this(this)});$(".js_cmt_form").unbind();$(".js_cmt_form").submit(function(){var n=$.trim($("#js_activity_feed_form #content").val());return n!=null&&n!=""&&($sFormAjaxRequest="cmt.add",$oLastFormSubmit=$(this),$(this).ajaxCall($sFormAjaxRequest)),!1});$(".form_reply").unbind();$(".form_reply").submit(function(){var n=$(this).find("textarea").val();return n!=null&&n!=""&&($sFormAjaxRequest="cmt.add",$oLastFormSubmit=$(this),$(this).ajaxCall($sFormAjaxRequest)),!1})};$Core.loadStaticFiles=function(n){if(typeof n=="string"&&(n=new Array(n)),!$bDocumentIsLoaded){isset($Cache.post_static_files)||($Cache.post_static_files=[]);$Cache.post_static_files.push(n);return}$(n).each(function(n,t){if(isset($oStaticHistory[t]))substr(t,-10)=="custom.css"&&(sCustomHistoryUrl=t);else if($oStaticHistory[t]=!0,substr(t,-3)==".js")$("head").append('<script type="text/javascript" src="'+t+"?v="+getParam("sStaticVersion")+'"><\/script>');else if(substr(t,-4)==".css"){var i="";substr(t,-10)=="custom.css"&&(sCustomHistoryUrl=t,i="js_custom_css_loader");$("head").append("<link "+i+' rel="stylesheet" type="text/css" href="'+t+"?v="+getParam("sStaticVersion")+'" />')}else $("head").append('<script type="text/javascript" src="'+t+"?v="+getParam("sStaticVersion")+'"><\/script>')});empty(sCustomHistoryUrl)||($("#js_custom_css_loader").remove(),$("head").append('<link id="js_custom_css_loader" rel="stylesheet" type="text/css" href="'+sCustomHistoryUrl+"?v="+getParam("sStaticVersion")+'" />'))};$(document).ready(function(){var n=$("#comment").attr("siteId"),t=$("#comment").attr("detailid"),i=$("#comment").attr("cmtcategoryid"),u=$("#comment").attr("hiderating"),f=$("#comment").attr("pageSize"),r;cmtroom="cn_"+n+"_"+i+"_"+t;$Core.init();cmtTrigEvent();try{empty(comment_jsload)||(console.log("build-first__"),r=$.ajaxCall("cmt.buildfirst",cmtGetextParam()))}catch(e){}setTimeout(function(){$Core.loadInit();cmtInitEvent()},1e3);try{}catch(e){}});discount=0;reconnectCount=0;tryReconnect=function(){++reconnectCount;reconnectCount==5&&clearInterval(intervalID);clearInterval(intervalID)};cmtnew=0;gl_rsCmtPS=!1;