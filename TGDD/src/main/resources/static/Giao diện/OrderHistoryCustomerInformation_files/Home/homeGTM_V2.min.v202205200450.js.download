function gtm_ProductImpressions(n,t,i,r,u,f,e){if(dataLayer===undefined){console.log("dataLayer chưa khai báo");return}var o=[{name:n,id:t,price:i,brand:r,category:u,list:f,position:e}],s={ecommerce:{impressions:o},event:"productImpressions"};dataLayer.push(s)}function addListProductIntoImpression(n,t,i){var f,u,s;if(n!==undefined&&n.length>0){(i===undefined||i<=0)&&(i=1);(t===undefined||t==null||t=="")&&(t="List product");var o=[],r={},e=0;for(f=0;f<n.length;f++)e++,u=n[f],s=u.parentNode.getAttribute("data-pos"),r.name=u.dataset.name,r.id=u.dataset.id,r.price=u.dataset.price,r.brand=u.dataset.brand,r.category=u.dataset.cate,r.list=t,r.position=s,gbl_siteId!==undefined&&(gbl_siteId==1?r.dimension88=u.dataset.isRecommended===undefined||u.dataset.isRecommended==="false"?"No":"Yes":gbl_siteId==2&&(r.dimension79=u.dataset.isRecommended===undefined||u.dataset.isRecommended==="false"?"No":"Yes")),o.push(r),r={},(f+1==n.length&&e<i||e==i)&&(gtm_ListProductImpressions(o),e=0,o=[])}}function gtm_ListProductImpressions(n){if(dataLayer===undefined){console.log("dataLayer chưa khai báo");return}if(n!==undefined&&n!=null&&n.length>0){var t={ecommerce:{impressions:n},event:"productImpressions"};dataLayer.push(t)}}function gtm_ProductClick(n,t,i,r,u,f,e,o="false"){var s,h;if(dataLayer===undefined){console.log("dataLayer chưa khai báo");return}s=[{name:n,id:t===undefined?"":t.toString(),price:i===undefined?"":i.toString(),brand:r,category:u,list:f,position:e===undefined?"":e.toString()}];gbl_siteId!==undefined&&(gbl_siteId==1?s[0].dimension88=o===undefined||o==="false"?"No":"Yes":gbl_siteId==2&&(s[0].dimension79=o===undefined||o==="false"?"No":"Yes"));h={ecommerce:{click:{products:s,actionField:{list:f}}},event:"productClick"};dataLayer.push(h)}function gtm_ProductDetailView(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){if(dataLayer===undefined){console.log("dataLayer chưa khai báo");return}var d=[{name:n,id:t,price:i,brand:r,category:u,dimension33:f,dimension34:e,dimension35:o,dimension36:s,dimension37:h,dimension16:c,dimension38:l,dimension39:a,dimension40:v,dimension41:y,dimension43:p,dimension44:w,dimension45:b}],g={event:"productDetail",serviceOrder:k,ecommerce:{detail:{products:d}}};dataLayer.push(g)}function gtm_ProductAddtoCart(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt){if(dataLayer===undefined){console.log("dataLayer chưa khai báo");return}var it=[{name:n,id:t,price:i,brand:r,category:u,variant:f,quantity:e,dimension33:o,dimension34:s,dimension35:h,dimension36:c,dimension37:l,dimension16:a,dimension38:v,dimension39:y,dimension40:p,dimension41:w,dimension43:b,dimension44:k,dimension45:d,dimension42:g}],rt={event:"productAddToCart",orderType:nt,serviceOrder:tt,ecommerce:{add:{products:it}}};dataLayer.push(rt)}function GetProductScroll(){var n,t,i,r,u;$(".prd-promo:not(.prd-another)").length>0&&(n=$(".prd-promo:not(.prd-another)").offset().top);$(".flashsale-block").length>0&&(t=$(".flashsale-block").offset().top);$(".prd-promo.prd-another").length>0&&(i=$(".prd-promo.prd-another").offset().top);$(".daily-sg").length>0&&(r=$(".daily-sg").offset().top);$(".prd-promo.promo-muanong").length>0&&(u=$(".prd-promo.promo-muanong").offset().top);$(window).scroll(()=>{var f=$(".prd-promo:not(.prd-another) .listproduct .active .item > a"),e=$(".flashsale-block .listproduct .slick-active .item > a").length>0?$(".flashsale-block .listproduct .slick-active .item > a"):$(".flashsale-block .listproduct .item > a"),o=$(".prd-promo.prd-another .listproduct .active .item > a"),s=$(".daily-sg .block-product__content").eq(0).find(".listproduct .item:not(.hide) > a"),h=$(".prd-promo.promo-muanong .block-product__content").eq(0).find(".listproduct .active .item > a");flagGetProductScrollPromo=ComparePosition(n,f,flagGetProductScrollPromo,"Home page - Tuần lễ săn sale");flagGetProductScrollFlashsale=ComparePosition(t,e,flagGetProductScrollFlashsale,"Home page - "+FormatString($(".flashsale-block .gvdshock h3").text()));flagGetProductScrollPromoManu=ComparePosition(i,o,flagGetProductScrollPromoManu,"Home page - "+FormatString($(".prd-promo.prd-another .prd-promo__title").text()));flagGetProductScrollRecommend=ComparePosition(r,s,flagGetProductScrollRecommend,"Home page - "+FormatString($(".option-sg a").eq(0).find("span").text()));flagGetProductScrollPromoteHotseason=ComparePosition(u,h,flagGetProductScrollPromoteHotseason,"Home page - Promote mùa nóng")})}function ComparePosition(n,t,i,r){if(i)return!0;var u=$(this).scrollTop();return u>=n-150&&u<=n+screen.height&&t.length>0?(addListProductIntoImpression(t,r,10),!0):!1}function FormatString(n){return n.trim().replace("\n","")}function GetTabByAttr(n){let t={isRecommendTab:n.data("is-recommend-tab"),campaignId:n.data("campaign"),groupId:n.data("group")};return $(".option-sg a"+(t.isRecommendTab==!0?"[data-is-recommend-tab="+t.isRecommendTab+"]":":not([data-is-recommend-tab])")+(t.campaignId!=null?"[data-campaign="+t.campaignId+"]":":not([data-campaign])")+(t.groupId!=null?"[data-group="+t.groupId+"]":":not([data-group])"))}$(document).ready(function(){$(document).on("click",".prd-promo:not(.prd-another) .listproduct .item a",function(){var n=$(this).data("name"),t=$(this).data("id"),i=$(this).data("price"),r=$(this).data("brand"),u=$(this).data("cate"),f=$(this).parent().data("pos"),e=$(this).data("is-recommended");gtm_ProductClick(n,t.toString(),i.toString(),r,u,"Home page - Tuần lễ săn sale",f.toString(),e)});$(document).on("click",".flashsale-block .listproduct .item a",function(){var n=$(this).data("name"),t=$(this).data("id"),i=$(this).data("price"),r=$(this).data("brand"),u=$(this).data("cate"),f="Home page - "+FormatString($(this).closest(".flashsale-block").find(".gvdshock h3").text()),e=$(this).parent().data("pos"),o=$(this).data("is-recommended");gtm_ProductClick(n,t.toString(),i.toString(),r,u,f,e.toString(),o)});$(document).on("click",".prd-promo.prd-another .listproduct .item a",function(){var n=$(this).data("name"),t=$(this).data("id"),i=$(this).data("price"),r=$(this).data("brand"),u=$(this).data("cate"),f="Home page - "+FormatString($(this).closest(".prd-promo.prd-another").find(".prd-promo__title").text()),e=$(this).parent().data("pos"),o=$(this).data("is-recommended");gtm_ProductClick(n,t.toString(),i.toString(),r,u,f,e.toString(),o)});$(document).on("click",".prd-promo.promo-muanong .listproduct .item a",function(){var n=$(this).data("name"),t=$(this).data("id"),i=$(this).data("price"),r=$(this).data("brand"),u=$(this).data("cate"),f=$(this).parent().data("pos"),e=$(this).data("is-recommended");gtm_ProductClick(n,t.toString(),i.toString(),r,u,"Home page - Promote mùa nóng",f.toString(),e)});$(document).on("click",".daily-sg .listproduct .item a",function(){var t=$(this).data("name"),i=$(this).data("id"),r=$(this).data("price"),u=$(this).data("brand"),f=$(this).data("cate"),e="Home page - "+FormatString(GetTabByAttr($(this).closest(".block-product__content")).find("span").text()),n=$(this).parent().data("pos");console.log(n);gtm_ProductClick(t,i.toString(),r.toString(),u,f,e,n.toString())});$(document).on("click",".prd-promo:not(.prd-another) .owl-nav button",function(){var n=$(".prd-promo:not(.prd-another) .listproduct .active .item > a"),t="";n.length>0&&(t="Home page - Tuần lễ săn sale",addListProductIntoImpression(n,t,5))});$(document).on("click",".flashsale-block button.slick-arrow",function(){var n=$(".flashsale-block .listproduct .slick-active .item > a"),t="";n.length>0&&(t="Home page - "+FormatString($(".flashsale-block .gvdshock h3").text()),addListProductIntoImpression(n,t,5))});$(document).on("click",".prd-promo.promo-muanong .owl-nav button",function(){var n=$(".prd-promo.promo-muanong .listproduct .active .item > a"),t="";n.length>0&&(t="Home page - Promote mùa nóng ",addListProductIntoImpression(n,t,5))});$(document).on("click",".prd-promo.prd-another .owl-nav button",function(){var n=$(".prd-promo.prd-another .listproduct .active .item > a"),t="";n.length>0&&(t="Home page - "+FormatString($(this).closest(".prd-promo.prd-another").find(".prd-promo__title").text()),addListProductIntoImpression(n,t,5))});GetProductScroll()});var flagGetProductScrollPromo=!1,flagGetProductScrollFlashsale=!1,flagGetProductScrollPromoManu=!1,flagGetProductScrollRecommend=!1,flagGetProductScrollPromoteHotseason=!1;